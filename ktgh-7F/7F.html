<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title></title>
    <link rel="stylesheet" href="7F.css">
</head>
<body>
    <!-- 1cm=25px -->
    <div id="main">
        
       
        <div id="room750" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">750</div>
        </div>
        <div id="room751" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">751
            </div>

        <div id="room752" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">752</div>

        <div id="room753" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">753</div>

        <div id="room755" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">755</div>

        <div id="room756" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">756</div>

        <div id="staris01" class="bgc_staris b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">
            出口1
                <div class="block">r8</div></div>
            </div>

        <div id="room757" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">757</div>

        <div id="room758" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">758</div>

        <div id="room759" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">759</div>

        <div id="room760" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">760</div>
        <div id="temp01" class="bgc_gray b1"
        ondrop="Drop(event)" ondragover="AllowDrop(event)">        
                <div class="block">r14</div></div>
            </div>

        <div id="temp02" class="bgc_gray b1"
        ondrop="Drop(event)" ondragover="AllowDrop(event)">            
                <div class="block">r18</div></div>>
            </div>
            
        <div id="room761" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">761</div>
        <div id="room762" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">762</div>
        <div id="room763" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">763</div>
        <div id="temp03" class="bgc_gray b1">temp03</div>
        <div id="staris02" class="bgc_staris b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">
                出口2
                <div class="block">r53</div></div>
        <div id="room701" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">701</div>
        <div id="room702" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">702</div>
        <div id="room703" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">703</div>
        <div id="staris03" class="bgc_staris b1" ondrop="Drop(event)" ondragover="AllowDrop(event)">  出口4
            <div class="block">r48</div></div>

        <div id="G-elevator01" class="bgc_staris b1">G-elevator01</div>
        <div id="temp04" class="bgc_gray b1">temp04</div>

        <div id="G-elevator02" class="bgc_staris b1">G-elevator02</div>

        <div id="nursing_station">
            <div id="b01" class="bgc_border"></div>
            <div id="b02" class="bgc_border"></div>
            <div id="b03" class="bgc_border"></div>
            <div id="b04" class="bgc_border"></div>
            <div id="b05" class="bgc_border"></div>
            <div id="b06" class="bgc_border"></div>
        護理站</div>
        <div id="room705" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">705</div>
        <div id="room706" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">706</div>
        <div id="room707" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">707</div>
        <div id="room720" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">720</div>
        <div id="room721" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">721</div>
        <div id="room722" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">722</div>
        <div id="room723" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">723</div>
        <div id="room725" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">725</div>
        <div id="room726" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">726</div>
        <div id="room727" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">727</div>
        <div id="staris04" class="bgc_staris b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">
                出口3
                <div class="block">r39</div></div>
        <div id="room727-2" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">727-2</div>
        <div id="room710" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">710</div>
        <div id="room711" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">711</div>
        <div id="room712" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">712</div>
        <div id="room713" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">713</div>
        <div id="room715" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">715</div>
        <div id="room716" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">716</div>
        <div id="temp19" class="bgc_gray b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">temp19</div>
        <div id="temp20" class="bgc_gray b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">temp20</div>
        <div id="temp18" class="bgc_gray b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">temp18</div>
        <div id="temp17" class="bgc_gray b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">temp17</div>
        <div id="temp16" class="bgc_gray b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">temp16</div>
        <div id="temp15" class="bgc_gray b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">temp15</div>
        <div id="temp14" class="bgc_white b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">temp14</div>
        <div id="elevator04" class="bgc_staris b1">elevator04</div>
        <div id="elevator05" class="bgc_staris b1">elevator05</div>
        <div id="stair06" class="bgc_staris b1"ondrop="Drop(event)" ondragover="AllowDrop(event)"
        >出口5
            <div class="block">r18</div>
        </div>
        <div id="elevator06" class="bgc_staris b1">elevator06</div>
        <div id="temp05" class="bgc_gray b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">temp05</div>
        <div id="room765" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">765</div>
        <div id="room766" class="bgc_yellow b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">766</div>
        <div id="temp06" class="bgc_gray b1"ondrop="Drop(event)" ondragover="AllowDrop(event)">temp06</div>
        <div id="cross_border" class="bgc_border">
            <div id="cross"></div>
        </div>

        <div id="r1" class="road">
            r1
            
            <div class="edge right">r2</div>
            <div class="arrow arrow_top start" style="left: calc(50% - 7px);"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r2" class="road">
            r2
            <div class="edge left">r1</div>
            <div class="edge right">r3</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r3" class="road">
            r3
            <div class="edge left">r2</div>
            <div class="edge right">r4</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r4" class="road">
            r4
            <div class="edge left">r3</div>
            <div class="edge right">r5</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r5" class="road">
            r5
            <div class="edge left">r4</div>
            <div class="edge right">r6</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r6" class="road">
            r6
            <div class="edge left">r5</div>
            <div class="edge right">r6</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r7" class="road">
            r7
            <div class="edge left">r6</div>
            <div class="edge right">r8</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
       
        <div id="r8" class="road start">
                r8
                <div class="edge left">r7</div>
                <div class="edge right">r9</div>
                <div class="arrow arrow_top start" style="left: calc(50% - 7px);"></div>
                <div class="arrow arrow_left"></div>
                <div class="arrow arrow_right"></div>
            </div>
        <div id="r9" class="road">
            r9
            <div class="edge left">r8</div>
            <div class="edge right">r10</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r10" class="road">
            r10
            <div class="edge left">r9</div>
            <div class="edge right">r11</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r11" class="road">
            r11
            <div class="edge left">r10</div>
            <div class="edge right">r12</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r12" class="road">
            r12
            <div class="edge left">r11</div>
            <div class="edge right">r13</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r13" class="road">
            r13
            <div class="edge left">r12</div>
            <div class="edge right">r14</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        
        <div id="r15" class="road">
            r15
            
            <div class="edge right">r20</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r16" class="road">
            r16
            <div class="edge top">r15</div>
            <div class="edge left">r17</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r17" class="road">
            r17
            <div class="edge top">r16</div>
            <div class="edge left">r18</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r18" class="road">
            r18
            <div class="edge top">r17</div>
            <div class="edge left">r19</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r19" class="road">
            r19
            <div class="edge top">r33</div>
            <div class="arrow arrow_bottom start" style="left: calc(50% - 7px);"></div>
            <div class="arrow arrow_bottom"></div>

        </div>
        <div id="r20" class="road">
            r20
            <div class="edge left">r15</div>
            <div class="edge right">r21</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r21" class="road">
            r21
            <div class="edge left">r20</div>
            <div class="edge right">r22</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r22" class="road">
            r22
            <div class="edge left">r21</div>
            <div class="edge right">r23</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r23" class="road">
            r23
            <div class="edge left">r22</div>
            <div class="edge right">r24</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r24" class="road">
            r24
            <div class="edge left">r23</div>
            <div class="edge right">r25</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r25" class="road">
            r25
            <div class="edge left">r24</div>
            <div class="edge right">r26</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r26" class="road">
            r26
            <div class="edge left">r25</div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r27" class="road">
            r27
            <div class="edge top">r28</div>
            <div class="edge left">r20</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r28" class="road">
            r28
            <div class="edge left">r29</div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r29" class="road">
            r29
            <div class="edge left">r28</div>
            <div class="edge right">r30</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r30" class="road">
            r30
            <div class="edge left">r29</div>
            <div class="edge right">r31</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r31" class="road">
            r31
            <div class="edge left">r30</div>
            <div class="edge right">r32</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r32" class="road">
            r32
            <div class="edge left">r31</div>
            <div class="edge right">r33</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r33" class="road">
            r33
            <div class="edge left">r32</div>
            <div class="edge right">r34</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r34" class="road">
            r34
            <div class="edge left">r33</div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r35" class="road">
            r35
            <div class="edge top">r36</div>
            <div class="edge left">r32</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r36" class="road">
            r36
            <div class="edge top">r40</div>
            <div class="edge left">r35</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r37" class="road">
            r37
            <div class="edge left">r36</div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r38" class="road">
            r38
            <div class="edge left">r39</div>
            <div class="edge right">r37</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r39" class="road">
            r39
            <div class="edge left">r40</div>
            <div class="edge right">r38</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r40" class="road">
            r40
            <div class="edge left">r41</div>
            <div class="edge right">r39</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r41" class="road">
            r41
            <div class="edge left">r42</div>
            <div class="edge right">r40</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r42" class="road">
            r42
            <div class="edge left">r43</div>
            <div class="edge right">r41</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r43" class="road">
            r43
            <div class="edge left">r47</div>
            <div class="edge right">r42</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r44" class="road">
            r44
            <div class="edge top">r45</div>
            <div class="edge left">r43</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r45" class="road">
            r45
            <div class="edge top">r46</div>
            <div class="edge left">r44</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r46" class="road">
            r46
            <div class="edge bottom">r45</div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r47" class="road">
            r47
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r48" class="road">
            r48
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r49" class="road">
            r49
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r50" class="road">
            r50
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r51" class="road">
            r51
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r52" class="road">
            r52
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r53" class="road">
            r53
            <div class="edge right">r52</div>
            <div class="arrow arrow_top start" style="left: calc(50% - 7px);"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r54" class="road">
            r54
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r55" class="road">
            r55
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r56" class="road">
            r56
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r57" class="road">
            r57
            <div class="edge right"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="fire_set" class="b1" ondrop="Drop(event)" ondragover="AllowDrop(event)">
            <img id="fire" src="fire-element.png" alt="fire" draggable="true" ondragstart="Drag(event)">
            <button onclick="goBack()" id="return_button">
                <img src="return.png" alt="return">
            </button>
        </div>

    </div>
    

    <script>
        function goBack() {
            reset();
            var fire = document.getElementById("fire");
            document.getElementById("fire_set").appendChild(fire);
            var returnButton = document.getElementById("return_button");
            returnButton.style.display = "none";
        }
        class Queue {
            constructor(){
                this.queue = []
            }
            enqueue(val){
                this.queue.unshift(val)
            }
            dequeue(){
                return this.queue.pop()
            }
            front() {
                return this.queue[this.queue.length - 1];
            }

            get length() {
                return this.queue.length;
            }
        }

        // create a graph class 
        class Graph { 
            // defining vertex array and 
            // adjacent list 
            constructor(noOfVertices) 
            { 
                this.noOfVertices = noOfVertices; 
                this.AdjList = new Map(); 
            } 
        
            // functions to be implemented 
        
            // add vertex to the graph 
            addVertex(v) 
            { 
                // initialize the adjacent list with a 
                // null array 
                this.AdjList.set(v, []); 
            }

            // add edge to the graph 
            addEdge(v, w) 
            { 
                // get the list for vertex v and put the 
                // vertex w denoting edge betweeen v and w 
                this.AdjList.get(v).push(w); 
            
                // Since graph is undirected, 
                // add an edge from w to v also 
                // this.AdjList.get(w).push(v); 
            }

            RemoveNode(node)
            {
                if (this.AdjList.has(node)) {
                    this.AdjList.delete(node);
                }

                var get_keys = this.AdjList.keys();
                for (var i of get_keys)  
                { 
                    var get_values = this.AdjList.get(i); 
            
                    var index = get_values.indexOf(node);
                    if (index !== -1) {
                        get_values.splice(index, 1);
                    }
                }
            }

            // Prints the vertex and adjacency list 
            printGraph() 
            { 
                // get all the vertices 
                var get_keys = this.AdjList.keys(); 
            
                // iterate over the vertices 
                for (var i of get_keys)  
                { 
                    // great the corresponding adjacency list 
                    // for the vertex 
                    var get_values = this.AdjList.get(i); 
                    var conc = ""; 
            
                    // iterate over the adjacency list 
                    // concatenate the values into a string 
                    for (var j of get_values) 
                        conc += j + " "; 
            
                    // print the vertex and its adjacency list 
                    console.log(i + " -> " + conc); 
                }
            }
        
            // Main DFS method 
            dfs(startingNode) 
            {
                var visited = []; 
                for (var i = 0; i < this.noOfVertices; i++) 
                    visited[i] = false; 
                
                this.DFSUtil(startingNode, visited); 
            } 
            
            // Recursive function which process and explore 
            // all the adjacent vertex of the vertex with which it is called 
            DFSUtil(vert, visited)
            {
                visited[vert] = true; 
                console.log(vert); 
            
                var get_neighbours = this.AdjList.get(vert); 
            
                for (var i in get_neighbours) {
                    var get_elem = get_neighbours[i];
                    if (!visited[get_elem]) 
                        this.DFSUtil(get_elem, visited);
                } 
            }

            printAllPaths(startingNode) {
                var visited = new Map();
                var path = [];
                var path_index = 0;
                for (var key of this.AdjList.keys()){
                    visited.set(key, false);
                }

                this.printAllPathsUtil(startingNode, visited, path, path_index, true); 
            }

            printAllPathsUtil(vert, visited, path, path_index, initial) {
                visited.set(vert, true);
                path[path_index] = vert;
                path_index++;

                var get_neighbours = this.AdjList.get(vert);

                if ( get_neighbours.length === 1 && !initial){
                    console.log(path)
                }
                else {
                    for (var i of get_neighbours) {
                        if (!visited.get(i) && i !== path[path_index - 1]) {
                            this.printAllPathsUtil(i, visited, path, path_index, false);
                        }
                    }
                }

                path_index--;
                path.pop();
                visited[vert] = false;
            }

            bfs(startingNode)
            {
                var color = new Map();
                var predecessor = new Map();
                var distance = new Map();

                var get_keys = this.AdjList.keys();
                for (var i of get_keys) {
                    color.set(i, 0);
                    predecessor.set(i, -1);
                    distance.set(i, this.noOfVertices + 1);
                }
                    
                var q = new Queue();
                var i = startingNode;

                for (var j of this.AdjList.keys()) {
                    if (color.get(i) === 0) {
                        color.set(i, 1);
                        distance.set(i, 0);
                        predecessor.set(i, -1);
                        q.enqueue(i);
                        while (q.length > 0) {
                            var u = q.front();
                            var get_List = this.AdjList.get(u);
                            for (var n of get_List){
                                if (color.get(n) === 0) {
                                    color.set(n, 1);
                                    distance.set(n, distance.get(u) + 1);
                                    predecessor.set(n, u);
                                    q.enqueue(n);
                                }
                            }
                            q.dequeue();
                            color.set(u, 2);
                        }
                    }
                    
                    i = j;
                }

                console.log(predecessor);
            }

            getShortestPath(startingNode, exits)
            {
                //Initialize
                var color = new Map();
                var predecessor = new Map();
                var distance = new Map();

                for (var i of this.AdjList.keys()) {
                    color.set(i, 0);
                    predecessor.set(i, -1);
                    distance.set(i, this.noOfVertices + 1);
                }

                var q = new Queue();
                var i = startingNode;
                var findTarget = '';
                var targets = exits;

                if (color.get(i) === 0) {
                    color.set(i, 1);
                    distance.set(i, 0);
                    predecessor.set(i, -1);
                    q.enqueue(i);
                    while (q.length > 0) {
                        var u = q.front();
                        var get_List = this.AdjList.get(u);
                        for (var n of get_List){
                            if (color.get(n) === 0) {
                                color.set(n, 1);
                                distance.set(n, distance.get(u) + 1);
                                predecessor.set(n, u);
                                q.enqueue(n);
                            }

                            if (targets.includes(n)) {
                                findTarget = n;
                                break;
                            }
                        }

                        if (findTarget !== '') {
                            break;
                        }
                        q.dequeue();
                        color.set(u, 2);
                    }
                }

                var result = [];
                var index = findTarget;
                result.push(index);
                if (index === '') {
                    
                }
                else{
                    while (index !== -1) {
                        var index = predecessor.get(index);
                        result.push(index);
                    }
                }
                
                return result;
            }

        }

        var main = document.getElementById("main");
        var road = Array.from(main.children).filter(m => m.tagName === "DIV" && m.className.includes("road"));
        var starts = Array.from(main.children).filter(m => m.tagName === "DIV" && m.className.includes("start"));
        var g = new Graph(road.length); 
        road.forEach(r => g.addVertex(r.id));
        road.forEach(r => {
            var edges = Array.from(r.children).filter(c => c.className.includes("edge"));
            edges.forEach(e => g.addEdge(r.id, e.textContent));
        });


        function activatePaths(blockNode = []) {
            reset();

            if (blockNode.length > 0) {
                blockNode.forEach(b => g.RemoveNode(b));
            }

            road.forEach(r => {
                console.log(`Start From ${r.id}`);

                var path = g.getShortestPath(r.id, ['r8', 'r18', 'r48', 'r39', 'r53']);
                console.log(path);
                //出口
                if (path[0] === r.id){
                    var t = r.getElementsByClassName("start");
                    t[0].style.display = "block";
                    console.log("出口")
                }
                //
                for (var e of r.children) {
                    if (!e.className.includes("edge")) {
                        continue;
                    }
                    if (path.includes(e.textContent)) {
                        if (e.className.includes("left")) {
                            var t = r.getElementsByClassName("arrow_left");
                            t[0].style.display = "block";
                        }
                        else if (e.className.includes("right")){
                            var t = r.getElementsByClassName("arrow_right");
                            t[0].style.display = "block";
                        }
                        else if (e.className.includes("top")){
                            var t = r.getElementsByClassName("arrow_top");
                            t[0].style.display = "block";
                        }
                        else if (e.className.includes("bottom")){
                            var t = r.getElementsByClassName("arrow_bottom");
                            t[0].style.display = "block";
                        }
                        else{
                            console.log("nothing");
                        }
                    }
                }

                console.log("---------------------------");
            });

        }

        function reset() {
            var arrows = document.getElementsByClassName("arrow")
            for (var a of arrows) {
                a.style.display = "none";
            }

            g = new Graph(road.length); 
            road.forEach(r => g.addVertex(r.id));
            road.forEach(r => {
                var edges = Array.from(r.children).filter(c => c.className.includes("edge"));
                edges.forEach(e => g.addEdge(r.id, e.textContent));
            });
        }

        //拖拉
        function AllowDrop(event){
            event.preventDefault();
        }
        function Drag(event){
            event.dataTransfer.setData("text",event.currentTarget.id);
        }
        function Drop(event){
            event.preventDefault();
            var data=event.dataTransfer.getData("text");
            event.currentTarget.appendChild(document.getElementById(data));
            
            var returnButton = document.getElementById("return_button");
            if (event.currentTarget.id === "fire_set") {
                reset();
                returnButton.style.display = "none";
            }
            else {
                returnButton.style.display = "block";

                var blocks = Array.from(event.currentTarget.children).filter(c => c.className.includes("block"));
                if (blocks.length > 0) {
                    blockNodes = blocks.map(b => b.textContent);
                    activatePaths(blockNodes);
                }
                else {
                    activatePaths();
                }
            }
        }
    </script>
</body>
</html>