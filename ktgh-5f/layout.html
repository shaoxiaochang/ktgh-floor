<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="layout.css">
</head>
<body>
    <div id="main">
        <div id="FuTien_border" class="bgc_border">
            <div id="FuTien" class="bgc_yellow">
            </div>
        </div>
        <div id="stair01" class="bgc_staris b1" ondrop="Drop(event)" ondragover="AllowDrop(event)">
            出口1
            <div class="block">r03</div>
        </div>
        <div id="temp01" class="bgc_yellow b1"></div>
        <div id="room501" class="bgc_yellow b1"></div>
        <div id="room502" class="bgc_yellow b1"></div>
        <div id="room503" class="bgc_yellow b1"></div>
        <div id="temp02" class="bgc_yellow b1"></div>
        <div id="temp03" class="bgc_gray b1"></div>
        <div id="NFTU_border" class="bgc_border">
            <div id="NFTU"></div>
        </div>
        <div id="temp04" class="bgc_yellow b1"></div>
        
        <div id="r01" class="road">
            r01
            <div class="edge bottom">r02</div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r02" class="road">
            r02
            <div class="edge left">r01</div>
            <div class="edge right">r03</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r03" class="road start">
            r03
            <div class="edge left">r02</div>
            <div class="edge right">r04</div>
            <div class="arrow arrow_top start" style="left: calc(50% - 7px);"></div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r04" class="road">
            r04
            <div class="edge left">r03</div>
            <div class="edge right">r05</div>
            <div class="edge bottom">r09</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
            <div class="arrow arrow_bottom" style="left: 17px;"></div>
        </div>
        <div id="r05" class="road">
            r05
            <div class="edge left">r04</div>
            <div class="edge right">r06</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r06" class="road">
            r06
            <div class="edge left">r05</div>
            <div class="edge right">r07</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r07" class="road">
            r07
            <div class="edge left">r06</div>
            <div class="edge right">r08</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r08" class="road">
            r08
            <div class="edge left">r07</div>
            <div class="edge right">r29</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>

        <div id="temp05" class="bgc_gray b1"></div>
        <div id="toilet01" class="b1"></div>
        <div id="room561" class="bgc_yellow b1" ondrop="Drop(event)" ondragover="AllowDrop(event)">
            561
            <div class="block">r11</div>
        </div>
        <div id="room505" class="bgc_yellow b1">505</div>
        <div id="room506" class="bgc_yellow b1">506</div>
        <div id="room507" class="bgc_yellow b1">507</div>
        <div id="cross_border" class="bgc_border">
            <div id="cross"></div>
        </div>
        <div id="temp06" class="bgc_gray b1"></div>

        <div id="r09" class="road">
            r09
            <div class="edge top">r04</div>
            <div class="edge bottom">r10</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r10" class="road">
            r10
            <div class="edge top">r09</div>
            <div class="edge bottom">r11</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r11" class="road">
            r11
            <div class="edge top">r10</div>
            <div class="edge bottom">r18</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>

        <div id="nursing_station">
            <div id="b01" class="bgc_border"></div>
            <div id="b02" class="bgc_border"></div>
            <div id="b03" class="bgc_border"></div>
            <div id="b04" class="bgc_border"></div>
            <div id="b05" class="bgc_border"></div>
            <div id="b06" class="bgc_border"></div>
        </div>

        <div id="road550_border" class="bgc_border">
            <div id="road550"></div>
        </div>

        <div id="r12" class="road">
            r12
            <div class="edge right">r13</div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r13" class="road">
            r13
            <div class="edge left">r12</div>
            <div class="edge right">r14</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r14" class="road">
            r14
            <div class="edge left">r13</div>
            <div class="edge right">r15</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r15" class="road">
            r15
            <div class="edge left">r14</div>
            <div class="edge right">r16</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r16" class="road">
            r16
            <div class="edge left">r15</div>
            <div class="edge right">r17</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r17" class="road">
            r17
            <div class="edge left">r16</div>
            <div class="edge right">r18</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r18" class="road start">
            r18
            <div class="edge top">r11</div>
            <div class="edge left">r17</div>
            <div class="edge right">r19</div>
            <div class="arrow arrow_bottom start" style="left: calc(50% - 7px);"></div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r19" class="road">
            r19
            <div class="edge left">r18</div>
            <div class="edge right">r20</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r20" class="road">
            r20
            <div class="edge left">r19</div>
            <div class="edge right">r21</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r21" class="road">
            r21
            <div class="edge left">r20</div>
            <div class="edge right">r22</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r22" class="road">
            r22
            <div class="edge left">r21</div>
            <div class="edge right">r23</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r23" class="road">
            r23
            <div class="edge left">r22</div>
            <div class="edge right">r57</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>

        <div id="room550" class="bgc_yellow b1" ondrop="Drop(event)" ondragover="AllowDrop(event)">550</div>
        <div id="room551" class="bgc_yellow b1" ondrop="Drop(event)" ondragover="AllowDrop(event)">551</div>
        <div id="room552" class="bgc_yellow b1">552</div>
        <div id="room553" class="bgc_yellow b1">553</div>
        <div id="room555" class="bgc_yellow b1">555</div>
        <div id="room556" class="bgc_yellow b1">556</div>
        <div id="stair02" class="bgc_staris b1" ondrop="Drop(event)" ondragover="AllowDrop(event)">
            出口2
            <div class="block">r18</div>
        </div>
        <div id="room557" class="bgc_yellow b1">557</div>
        <div id="room558" class="bgc_yellow b1">558</div>
        <div id="room559" class="bgc_yellow b1">559</div>
        <div id="room560" class="bgc_yellow b1">560</div>
        <div id="temp071" class="bgc_gray b1"></div>
        <div id="temp072" class="bgc_gray b1"></div>
        
        <div id="r24" class="road">
            r24
            <div class="edge bottom">r25</div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r25" class="road">
            r25
            <div class="edge top">r24</div>
            <div class="edge right">r26</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r26" class="road">
            r26
            <div class="edge left">r25</div>
            <div class="edge right">r27</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r27" class="road">
            r27
            <div class="edge top">r26</div>
            <div class="edge bottom">r28</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r28" class="road">
            r28
            <div class="edge top">r27</div>
            <div class="edge bottom">r29</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r29" class="road">
            r29
            <div class="edge top">r28</div>
            <div class="edge left">r08</div>
            <div class="edge right">r30</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r30" class="road start">
            r30
            <div class="edge left">r29</div>
            <div class="arrow arrow_top start" style="left: calc(50% - 7px);"></div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r31" class="road">
            r31
            <div class="edge left">r30</div>
            <div class="edge right">r32</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r32" class="road">
            r32
            <div class="edge top">r33</div>
            <div class="edge left">r31</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r33" class="road">
            r33
            <div class="edge top">r34</div>
            <div class="edge bottom">r32</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r34" class="road">
            r34
            <div class="edge top">r35</div>
            <div class="edge bottom">r33</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r35" class="road">
            r35
            <div class="edge top">r36</div>
            <div class="edge bottom">r34</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r36" class="road">
            r36
            <div class="edge bottom">r35</div>
            <div class="arrow arrow_bottom"></div>
        </div>

        <div id="r37" class="road">
            r37
            <div class="edge left">r32</div>
            <div class="edge right">r38</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r38" class="road">
            r38
            <div class="edge left">r37</div>
            <div class="edge right">r39</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r39" class="road">
            r39
            <div class="edge left">r38</div>
            <div class="edge right">r40</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r40" class="road start">
            r40
            <div class="edge left">r39</div>
            <div class="edge right">r401</div>
            <div class="arrow arrow_bottom start" style="left: calc(50% - 7px);"></div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r401" class="road">
            r401
            <div class="edge left">r40</div>
            <div class="edge right">r41</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r41" class="road">
            r41
            <div class="edge left">r40</div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r42" class="road">
            r42
            <div class="edge top">r39</div>
            <div class="edge bottom">r43</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r43" class="road">
            r43
            <div class="edge top">r42</div>
            <div class="edge bottom">r50</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r44" class="road">
            r44
            <div class="edge left">r55</div>
            <div class="edge right">r45</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r45" class="road">
            r45
            <div class="edge left">r44</div>
            <div class="edge right">r46</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r46" class="road">
            r46
            <div class="edge left">r45</div>
            <div class="edge right">r47</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r47" class="road">
            r47
            <div class="edge left">r46</div>
            <div class="edge right">r48</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r48" class="road">
            r48
            <div class="edge left">r47</div>
            <div class="edge right">r49</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r49" class="road">
            r49
            <div class="edge left">r48</div>
            <div class="edge right">r50</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r50" class="road">
            r50
            <div class="edge top">r43</div>
            <div class="edge left">r49</div>
            <div class="edge right">r51</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r51" class="road">
            r51
            <div class="edge left">r50</div>
            <div class="edge right">r52</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r52" class="road">
            r52
            <div class="edge left">r51</div>
            <div class="edge right">r53</div>
            <div class="arrow arrow_left"></div>
            <div class="arrow arrow_right"></div>
        </div>
        <div id="r53" class="road">
            r53
            <div class="edge left">r52</div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r54" class="road">
            r54
            <div class="edge top">r30</div>
            <div class="edge bottom">r55</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r55" class="road">
            r55
            <div class="edge top">r54</div>
            <div class="edge bottom">r56</div>
            <div class="edge right">r44</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
            <div class="arrow arrow_left"></div>
        </div>
        <div id="r56" class="road">
            r56
            <div class="edge top">r55</div>
            <div class="edge bottom">r57</div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_bottom"></div>
        </div>
        <div id="r57" class="road start">
            r57
            <div class="edge top">r56</div>
            <div class="edge left">r23</div>
            <div class="arrow arrow_bottom start" style="left: calc(50% - 7px);"></div>
            <div class="arrow arrow_top"></div>
            <div class="arrow arrow_left"></div>
        </div>

        <div id="temp08" class="bgc_gray b1"></div>
        <div id="temp09_border" class="bgc_border">
            <div id="temp09" class="bgc_gray"></div>
        </div>
        <div id="temp10_border" class="bgc_border">
            <div id="temp10" class="bgc_gray"></div>
        </div>
        <div id="temp11_border" class="bgc_border">
            <div id="temp11" class="bgc_white"></div>
        </div>
        <div id="stair03" class="bgc_staris b1">
            出口3
        </div>
        <div id="elevator01" class="bgc_staris b1"></div>
        <div id="temp12" class="bgc_white b1"></div>
        <div id="temp13" class="bgc_gray b1"></div>
        <div id="elevator02" class="bgc_staris b1"></div>
        <div id="elevator03" class="bgc_staris b1"></div>
        <div class="straight_line" style="height: 63px; top:126px; left:792px;"></div>
        <div class="horizontal_line" style="width: 25px; top:129px; left:837px;"></div>
        <div class="straight_line" style="height: 121px; top:129px; left:837px;"></div>

        <div id="liver_center_border" class="bgc_border">
            <div id="liver_center" class="bgc_pink"></div>
        </div>
        <div id="CDJEJ_border" class="bgc_border">
            <div id="CDCEJ" class="bgc_pink"></div>
        </div>
        <div id="Dept_of_Nurition" class="bgc_pink b1">            
        </div>
        <div id="CAPD_border" class="bgc_border">
            <div id="CAPD" class="bgc_pink"></div>
        </div>
        <div id="conference_room5" class="bgc_pink b1"></div>
        <div id="stair04" class="bgc_staris b1">

        </div>
        <div id="conference_room6" class="bgc_pink b1"></div>

        <div id="room525" class="bgc_yellow b1">
            525
        </div>
        <div id="room526" class="bgc_yellow b1">
            526
        </div>
        <div id="room527" class="bgc_yellow b1">
            527
        </div>
        <div id="room528" class="bgc_yellow b1">
            528
        </div>
        <div id="room529" class="bgc_yellow b1">
            529
        </div>
        <div class="straight_line" style="height: 28px; top:338px; left:1199px;"></div>

        <div id="temp14" class="bgc_white b1"></div>
        <div id="temp15" class="bgc_gray b1"></div>
        <div id="temp16" class="bgc_gray b1"></div>
        <div id="temp17" class="bgc_gray b1"></div>
        <div id="temp18" class="bgc_gray b1"></div>
        <div id="temp19" class="bgc_gray b1"></div>
        <div id="temp20" class="bgc_gray b1"></div>

        <div id="stair05" class="bgc_staris b1">
            出口4
        </div>
        <div id="temp21" class="bgc_yellow b1"></div>
        <div id="room531" class="bgc_yellow b1">
            531
        </div>
        <div class="straight_line" style="height: 27px; top:438px; left:1199px;"></div>

        <div id="room513" class="bgc_yellow b1">
            513
        </div>
        <div id="room515" class="bgc_yellow b1">
            515
        </div>
        <div id="room516" class="bgc_yellow b1">
            516
        </div>
        <div id="room517" class="bgc_yellow b1">
            517
        </div>
        <div id="room518" class="bgc_yellow b1">
            518
        </div>
        <div id="room519" class="bgc_yellow b1">
            519
        </div>
        <div id="room520" class="bgc_yellow b1">
            520
        </div>
        <div id="room521" class="bgc_yellow b1">
            521
        </div>
        <div id="room522" class="bgc_yellow b1">
            522
        </div>
        <div id="room523" class="bgc_yellow b1">
            523
        </div>
        
        <div id="temp22" class="bgc_white b1"></div>
        <div id="temp23_border" class="bgc_border">
            <div id="temp23" class="bgc_white"></div>
        </div>
        <div id="elevator04" class="bgc_staris b1"></div>
        <div id="elevator05" class="bgc_staris b1"></div>
        <div id="stair06" class="bgc_staris b1">
            出口5
        </div>
        <div id="elevator06" class="bgc_staris b1"></div>
        <div id="temp24" class="bgc_white b1"></div>
        <div class="straight_line" style="height: 26px; top:718px; left:635px;"></div>

        <div id="fire_set" class="b1" ondrop="Drop(event)" ondragover="AllowDrop(event)">
            <img id="fire" src="fire-element.png" alt="fire" draggable="true" ondragstart="Drag(event)">
            <button onclick="goBack()" id="return_button">
                <img src="return.png" alt="return">
            </button>
        </div>

        
        
    </div>

    <script>
        function goBack() {
            reset();
            var fire = document.getElementById("fire");
            document.getElementById("fire_set").appendChild(fire);
            var returnButton = document.getElementById("return_button");
            returnButton.style.display = "none";
        }
        class Queue {
            constructor(){
                this.queue = []
            }
            enqueue(val){
                this.queue.unshift(val)
            }
            dequeue(){
                return this.queue.pop()
            }
            front() {
                return this.queue[this.queue.length - 1];
            }

            get length() {
                return this.queue.length;
            }
        }

        // create a graph class 
        class Graph { 
            // defining vertex array and 
            // adjacent list 
            constructor(noOfVertices) 
            { 
                this.noOfVertices = noOfVertices; 
                this.AdjList = new Map(); 
            } 
        
            // functions to be implemented 
        
            // add vertex to the graph 
            addVertex(v) 
            { 
                // initialize the adjacent list with a 
                // null array 
                this.AdjList.set(v, []); 
            }

            // add edge to the graph 
            addEdge(v, w) 
            { 
                // get the list for vertex v and put the 
                // vertex w denoting edge betweeen v and w 
                this.AdjList.get(v).push(w); 
            
                // Since graph is undirected, 
                // add an edge from w to v also 
                // this.AdjList.get(w).push(v); 
            }

            RemoveNode(node)
            {
                if (this.AdjList.has(node)) {
                    this.AdjList.delete(node);
                }

                var get_keys = this.AdjList.keys();
                for (var i of get_keys)  
                { 
                    var get_values = this.AdjList.get(i); 
            
                    var index = get_values.indexOf(node);
                    if (index !== -1) {
                        get_values.splice(index, 1);
                    }
                }
            }

            // Prints the vertex and adjacency list 
            printGraph() 
            { 
                // get all the vertices 
                var get_keys = this.AdjList.keys(); 
            
                // iterate over the vertices 
                for (var i of get_keys)  
                { 
                    // great the corresponding adjacency list 
                    // for the vertex 
                    var get_values = this.AdjList.get(i); 
                    var conc = ""; 
            
                    // iterate over the adjacency list 
                    // concatenate the values into a string 
                    for (var j of get_values) 
                        conc += j + " "; 
            
                    // print the vertex and its adjacency list 
                    console.log(i + " -> " + conc); 
                }
            }
        
            // Main DFS method 
            dfs(startingNode) 
            {
                var visited = []; 
                for (var i = 0; i < this.noOfVertices; i++) 
                    visited[i] = false; 
                
                this.DFSUtil(startingNode, visited); 
            } 
            
            // Recursive function which process and explore 
            // all the adjacent vertex of the vertex with which it is called 
            DFSUtil(vert, visited)
            {
                visited[vert] = true; 
                console.log(vert); 
            
                var get_neighbours = this.AdjList.get(vert); 
            
                for (var i in get_neighbours) {
                    var get_elem = get_neighbours[i];
                    if (!visited[get_elem]) 
                        this.DFSUtil(get_elem, visited);
                } 
            }

            printAllPaths(startingNode) {
                var visited = new Map();
                var path = [];
                var path_index = 0;
                for (var key of this.AdjList.keys()){
                    visited.set(key, false);
                }

                this.printAllPathsUtil(startingNode, visited, path, path_index, true); 
            }

            printAllPathsUtil(vert, visited, path, path_index, initial) {
                visited.set(vert, true);
                path[path_index] = vert;
                path_index++;

                var get_neighbours = this.AdjList.get(vert);

                if ( get_neighbours.length === 1 && !initial){
                    console.log(path)
                }
                else {
                    for (var i of get_neighbours) {
                        if (!visited.get(i) && i !== path[path_index - 1]) {
                            this.printAllPathsUtil(i, visited, path, path_index, false);
                        }
                    }
                }

                path_index--;
                path.pop();
                visited[vert] = false;
            }

            bfs(startingNode)
            {
                var color = new Map();
                var predecessor = new Map();
                var distance = new Map();

                var get_keys = this.AdjList.keys();
                for (var i of get_keys) {
                    color.set(i, 0);
                    predecessor.set(i, -1);
                    distance.set(i, this.noOfVertices + 1);
                }
                    
                var q = new Queue();
                var i = startingNode;

                for (var j of this.AdjList.keys()) {
                    if (color.get(i) === 0) {
                        color.set(i, 1);
                        distance.set(i, 0);
                        predecessor.set(i, -1);
                        q.enqueue(i);
                        while (q.length > 0) {
                            var u = q.front();
                            var get_List = this.AdjList.get(u);
                            for (var n of get_List){
                                if (color.get(n) === 0) {
                                    color.set(n, 1);
                                    distance.set(n, distance.get(u) + 1);
                                    predecessor.set(n, u);
                                    q.enqueue(n);
                                }
                            }
                            q.dequeue();
                            color.set(u, 2);
                        }
                    }
                    
                    i = j;
                }

                console.log(predecessor);
            }

            getShortestPath(startingNode, exits)
            {
                //Initialize
                var color = new Map();
                var predecessor = new Map();
                var distance = new Map();

                for (var i of this.AdjList.keys()) {
                    color.set(i, 0);
                    predecessor.set(i, -1);
                    distance.set(i, this.noOfVertices + 1);
                }

                var q = new Queue();
                var i = startingNode;
                var findTarget = '';
                var targets = exits;

                if (color.get(i) === 0) {
                    color.set(i, 1);
                    distance.set(i, 0);
                    predecessor.set(i, -1);
                    q.enqueue(i);
                    while (q.length > 0) {
                        var u = q.front();
                        var get_List = this.AdjList.get(u);
                        for (var n of get_List){
                            if (color.get(n) === 0) {
                                color.set(n, 1);
                                distance.set(n, distance.get(u) + 1);
                                predecessor.set(n, u);
                                q.enqueue(n);
                            }

                            if (targets.includes(n)) {
                                findTarget = n;
                                break;
                            }
                        }

                        if (findTarget !== '') {
                            break;
                        }
                        q.dequeue();
                        color.set(u, 2);
                    }
                }

                var result = [];
                var index = findTarget;
                result.push(index);
                if (index === '') {
                    
                }
                else{
                    while (index !== -1) {
                        var index = predecessor.get(index);
                        result.push(index);
                    }
                }
                
                return result;
            }

        }

        var main = document.getElementById("main");
        var road = Array.from(main.children).filter(m => m.tagName === "DIV" && m.className.includes("road"));
        var starts = Array.from(main.children).filter(m => m.tagName === "DIV" && m.className.includes("start"));
        var g = new Graph(road.length); 
        road.forEach(r => g.addVertex(r.id));
        road.forEach(r => {
            var edges = Array.from(r.children).filter(c => c.className.includes("edge"));
            edges.forEach(e => g.addEdge(r.id, e.textContent));
        });


        function activatePaths(blockNode = []) {
            reset();

            if (blockNode.length > 0) {
                blockNode.forEach(b => g.RemoveNode(b));
            }

            road.forEach(r => {
                console.log(`Start From ${r.id}`);

                var path = g.getShortestPath(r.id, ['r03', 'r18', 'r30', 'r40', 'r57']);
                console.log(path);
                //出口
                if (path[0] === r.id){
                    var t = r.getElementsByClassName("start");
                    t[0].style.display = "block";
                    console.log("出口")
                }
                //
                for (var e of r.children) {
                    if (!e.className.includes("edge")) {
                        continue;
                    }
                    if (path.includes(e.textContent)) {
                        if (e.className.includes("left")) {
                            var t = r.getElementsByClassName("arrow_left");
                            t[0].style.display = "block";
                        }
                        else if (e.className.includes("right")){
                            var t = r.getElementsByClassName("arrow_right");
                            t[0].style.display = "block";
                        }
                        else if (e.className.includes("top")){
                            var t = r.getElementsByClassName("arrow_top");
                            t[0].style.display = "block";
                        }
                        else if (e.className.includes("bottom")){
                            var t = r.getElementsByClassName("arrow_bottom");
                            t[0].style.display = "block";
                        }
                        else{
                            console.log("nothing");
                        }
                    }
                }

                console.log("---------------------------");
            });

        }

        function reset() {
            var arrows = document.getElementsByClassName("arrow")
            for (var a of arrows) {
                a.style.display = "none";
                a.classList.remove("twinkling");
            }

            g = new Graph(road.length); 
            road.forEach(r => g.addVertex(r.id));
            road.forEach(r => {
                var edges = Array.from(r.children).filter(c => c.className.includes("edge"));
                edges.forEach(e => g.addEdge(r.id, e.textContent));
            });
        }

        //拖拉
        function AllowDrop(event){
            event.preventDefault();
        }
        function Drag(event){
            event.dataTransfer.setData("text",event.currentTarget.id);
        }
        function Drop(event){
            reset();

            event.preventDefault();
            var data=event.dataTransfer.getData("text");
            event.currentTarget.appendChild(document.getElementById(data));
            
            var returnButton = document.getElementById("return_button");
            if (event.currentTarget.id === "fire_set") {     
                returnButton.style.display = "none";
            }
            else {
                returnButton.style.display = "block";

                var blocks = Array.from(event.currentTarget.children).filter(c => c.className.includes("block"));
                if (blocks.length > 0) {
                    blockNodes = blocks.map(b => b.textContent);
                    activatePaths(blockNodes);
                }
                else {
                    activatePaths();
                }

            }
        }

        function enableTwinkling(){
            var arrows = document.getElementsByClassName("arrow");
            Array.from(arrows).forEach(a => a.classList.add("twinkling"))
        }
        function disableTwinkling(){
            var arrows = document.getElementsByClassName("arrow");
            Array.from(arrows).forEach(a => a.classList.remove("twinkling"))
        }
    </script>
</body>
</html>